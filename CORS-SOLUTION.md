# حل مشكلة CORS مع GitHub Pages

## المشكلة
عند تشغيل موقع NOON TV على GitHub Pages، لا تعمل روابط M3U8 بسبب سياسات الأمان (CORS - Cross-Origin Resource Sharing). هذا يحدث لأن GitHub Pages يمنع الوصول المباشر لملفات M3U8 من مصادر خارجية.

## الحلول المطبقة

### 1. CORS Proxy التلقائي
تم إضافة نظام CORS Proxy تلقائي في `script.js`:
- يكتشف تلقائياً إذا كان الموقع يعمل على GitHub Pages
- يطبق وكيل CORS على روابط M3U8 تلقائياً
- يستخدم عدة خدمات وكيل للاعتمادية

### 2. أداة CORS Proxy اليدوية
تم إنشاء صفحة `cors-proxy.html` تسمح بـ:
- تحويل روابط M3U8 يدوياً إلى روابط وكيل
- نسخ الروابط المحولة بسهولة
- استخدامها في التطبيق

### 3. خدمات الوكيل المستخدمة
- `https://api.allorigins.win/raw?url=`
- `https://corsproxy.io/?`
- `https://thingproxy.freeboard.io/fetch/`
- `https://cors-anywhere.herokuapp.com/`

## كيفية الاستخدام

### الاستخدام التلقائي
1. ارفع الملفات إلى GitHub Pages
2. سيعمل النظام تلقائياً على تطبيق CORS Proxy
3. لا حاجة لإجراءات إضافية

### الاستخدام اليدوي
1. افتح صفحة "حل مشاكل CORS" من القائمة الجانبية
2. أدخل رابط M3U8
3. انسخ الرابط المحول
4. استخدمه في إضافة قناة جديدة

## الملفات المحدثة

### script.js
- إضافة دوال `isGitHubPages()` و `applyCorsProxy()`
- تحديث `loadVideoStream()` لتطبيق CORS Proxy
- إضافة معالجة أخطاء محسنة
- إضافة إعادة المحاولة التلقائية

### style.css
- إضافة أنماط لرسائل الخطأ
- إضافة أنماط لأزرار إعادة المحاولة

### cors-proxy.html
- صفحة جديدة لحل مشاكل CORS يدوياً
- واجهة سهلة الاستخدام
- نسخ تلقائي للروابط المحولة

### index.html
- إضافة رابط لأداة CORS Proxy في القائمة الجانبية

## نصائح إضافية

1. **إذا توقف وكيل عن العمل**: النظام سيحاول تلقائياً وكيل آخر
2. **للقنوات الجديدة**: استخدم أداة CORS Proxy اليدوية لتحويل الروابط
3. **للاختبار المحلي**: النظام لا يطبق CORS Proxy عند التشغيل محلياً

## استكشاف الأخطاء

إذا لم تعمل القنوات:
1. تحقق من اتصال الإنترنت
2. جرب رابط مختلف للقناة
3. استخدم أداة CORS Proxy اليدوية
4. تحقق من وحدة تحكم المتصفح للأخطاء

## التحديثات المستقبلية
- إضافة المزيد من خدمات الوكيل
- تحسين آلية التبديل التلقائي
- إضافة إحصائيات نجاح/فشل الوكيل
